<!DOCTYPE html>
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>

<meta charset="utf-8">
<meta content="quarto-1.3.340" name="generator">

<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport">

<meta content="YH" name="author">
<meta content="2022-05-16" name="dcterms.date">

<title>Datenanalyse ALM - Messwiederholung</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="1_ALM_3_files/libs/clipboard/clipboard.min.js"></script>
<script src="1_ALM_3_files/libs/quarto-html/quarto.js"></script>
<script src="1_ALM_3_files/libs/quarto-html/popper.min.js"></script>
<script src="1_ALM_3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="1_ALM_3_files/libs/quarto-html/anchor.min.js"></script>
<link rel="stylesheet" href="1_ALM_3_files/libs/quarto-html/tippy.css">
<link id="quarto-text-highlighting-styles" rel="stylesheet" href="1_ALM_3_files/libs/quarto-html/quarto-syntax-highlighting.css">
<script src="1_ALM_3_files/libs/bootstrap/bootstrap.min.js"></script>
<link rel="stylesheet" href="1_ALM_3_files/libs/bootstrap/bootstrap-icons.css">
<link data-mode="light" id="quarto-bootstrap" rel="stylesheet" href="1_ALM_3_files/libs/bootstrap/bootstrap.min.css">
<style>html{ scroll-behavior: smooth; }</style>


<link href="../style.css" rel="stylesheet">
</head>

<body><div class="header"><div class="nav-item"><a href="../Sitzungen/">Sitzungen</a><div class="nav-list"><div class="nav-item"><a href="../Sitzungen/1_ALM_1.html">1_ALM_1</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_1_L.html">1_ALM_1_L</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_2.html">1_ALM_2</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_3.html">1_ALM_3</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_4.html">1_ALM_4</a></div></div></div><div class="nav-item"><a href="../Vorkurs/">Vorkurs</a><div class="nav-list"><div class="nav-item"><a href="../Vorkurs/Sitzung1.html">Sitzung1</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung2.html">Sitzung2</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung3.html">Sitzung3</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung4.html">Sitzung4</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung5.html">Sitzung5</a></div></div></div></div>

<div class="page-columns page-rows-contents page-layout-article" id="quarto-content">
<div class="sidebar margin-sidebar" id="quarto-margin-sidebar">
  <nav class="toc-active" role="doc-toc" id="TOC">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a data-scroll-target="#allgemeines-lineares-modell---messwiederholung" class="nav-link active" id="toc-allgemeines-lineares-modell---messwiederholung" href="#allgemeines-lineares-modell---messwiederholung">Allgemeines Lineares Modell - Messwiederholung</a>
  <ul class="collapse">
  <li><a data-scroll-target="#vorbereitung" class="nav-link" id="toc-vorbereitung" href="#vorbereitung">Vorbereitung</a></li>
  <li><a data-scroll-target="#transformation-der-daten-ins-long-format" class="nav-link" id="toc-transformation-der-daten-ins-long-format" href="#transformation-der-daten-ins-long-format">Transformation der Daten ins Long-Format</a></li>
  <li><a data-scroll-target="#visuelle-analyse" class="nav-link" id="toc-visuelle-analyse" href="#visuelle-analyse">Visuelle Analyse</a>
  <ul class="collapse">
  <li><a data-scroll-target="#deskriptive-analyse" class="nav-link" id="toc-deskriptive-analyse" href="#deskriptive-analyse">Deskriptive Analyse</a></li>
  </ul></li>
  <li><a data-scroll-target="#modell-mit-zeitpunkt-als-prädiktor" class="nav-link" id="toc-modell-mit-zeitpunkt-als-prädiktor" href="#modell-mit-zeitpunkt-als-prädiktor">Modell mit Zeitpunkt als Prädiktor</a>
  <ul class="collapse">
  <li><a data-scroll-target="#schritt-1-allgemeines-lineares-modell-anpassen" class="nav-link" id="toc-schritt-1-allgemeines-lineares-modell-anpassen" href="#schritt-1-allgemeines-lineares-modell-anpassen">Schritt 1: Allgemeines lineares Modell anpassen</a></li>
  <li><a data-scroll-target="#kritisches-problem-des-modells-abhängigkeit-der-messungen-check-3" class="nav-link" id="toc-kritisches-problem-des-modells-abhängigkeit-der-messungen-check-3" href="#kritisches-problem-des-modells-abhängigkeit-der-messungen-check-3">Kritisches Problem des Modells: Abhängigkeit der Messungen (Check 3)</a></li>
  </ul></li>
  <li><a data-scroll-target="#quick-fix-messwiederholungsvarianzanalyse" class="nav-link" id="toc-quick-fix-messwiederholungsvarianzanalyse" href="#quick-fix-messwiederholungsvarianzanalyse">Quick fix: Messwiederholungsvarianzanalyse</a></li>
  <li><a data-scroll-target="#einfachere-lösung-multilevel-modell" class="nav-link" id="toc-einfachere-lösung-multilevel-modell" href="#einfachere-lösung-multilevel-modell">Einfachere Lösung: Multilevel-Modell</a>
  <ul class="collapse">
  <li><a data-scroll-target="#check-2-prüfung-der-residuen" class="nav-link" id="toc-check-2-prüfung-der-residuen" href="#check-2-prüfung-der-residuen">Check 2: Prüfung der Residuen</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main id="quarto-document-content" class="content">

<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title">Datenanalyse ALM - Messwiederholung</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>YH </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 16, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section class="level1" id="allgemeines-lineares-modell---messwiederholung">
<h1>Allgemeines Lineares Modell - Messwiederholung</h1>
<p>In den letzten Sitzungen haben wir schon einige wichtige Eckpunkte des ALM (wieder) kennen gelernt. Wir haben aber leider noch ignoriert, dass wir in unserem Design eine wichtige Besonderheit haben: eine Messwiederholung. Jede Person durchläuft nämlich sowohl eine Prä- als auch eine Post-Messung. Heute wollen wir versuchen, das akkurater zu analysieren.</p>
<section class="level2" id="vorbereitung">
<h2 data-anchor-id="vorbereitung" class="anchored">Vorbereitung</h2>
<p>Wie gehabt laden wir Pakete und Daten.</p>
<div class="cell">
<div id="cb1" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a tabindex="-1" aria-hidden="true" href="#cb1-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a tabindex="-1" aria-hidden="true" href="#cb1-2"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-3"><a tabindex="-1" aria-hidden="true" href="#cb1-3"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-4"><a tabindex="-1" aria-hidden="true" href="#cb1-4"></a><span class="fu">library</span>(car)</span>
<span id="cb1-5"><a tabindex="-1" aria-hidden="true" href="#cb1-5"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-6"><a tabindex="-1" aria-hidden="true" href="#cb1-6"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb1-7"><a tabindex="-1" aria-hidden="true" href="#cb1-7"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb1-8"><a tabindex="-1" aria-hidden="true" href="#cb1-8"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-9"><a tabindex="-1" aria-hidden="true" href="#cb1-9"></a><span class="fu">library</span>(predictmeans)</span>
<span id="cb1-10"><a tabindex="-1" aria-hidden="true" href="#cb1-10"></a><span class="fu">library</span>(ez)</span>
<span id="cb1-11"><a tabindex="-1" aria-hidden="true" href="#cb1-11"></a><span class="fu">library</span>(lme4)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>Auch hier bitte darauf achten, dass das Verzeichnis für die Datei stimmt.</p>
<div class="cell">
<div id="cb2" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a tabindex="-1" aria-hidden="true" href="#cb2-1"></a><span class="co">#setwd("Sitzungen")</span></span>
<span id="cb2-2"><a tabindex="-1" aria-hidden="true" href="#cb2-2"></a>dat_1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"Dat_VR_Anxiety_lm1.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">dec =</span> <span class="st">"."</span>, <span class="at">na.strings =</span> <span class="st">"NA"</span>)</span>
<span id="cb2-3"><a tabindex="-1" aria-hidden="true" href="#cb2-3"></a></span>
<span id="cb2-4"><a tabindex="-1" aria-hidden="true" href="#cb2-4"></a><span class="co"># Characterstrings als Faktoren definieren</span></span>
<span id="cb2-5"><a tabindex="-1" aria-hidden="true" href="#cb2-5"></a>dat_1<span class="sc">$</span>Gruppe <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat_1<span class="sc">$</span>Gruppe) </span>
<span id="cb2-6"><a tabindex="-1" aria-hidden="true" href="#cb2-6"></a>dat_1<span class="sc">$</span>Gruppe <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_1<span class="sc">$</span>Gruppe, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"in_virtuo"</span>, <span class="st">"in_sensu"</span>, <span class="st">"Warteliste"</span>)) </span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="level2" id="transformation-der-daten-ins-long-format">
<h2 data-anchor-id="transformation-der-daten-ins-long-format" class="anchored">Transformation der Daten ins Long-Format</h2>
<p>Heute kommen wir auf einen wichtigen Inhalt des Vorkurses, die Datentransformation, zurück.</p>
<p>Nur durch eine Transformation ins Long-Format kann jeder der Messzeitpunkte ein Prädiktor sein. Jeder Prädiktor muss eine Variable in einer Spalte sein =&gt; damit kommt jede Person zwei Mal vor, d.h. in zwei Zeilen.</p>
<div class="cell">
<div id="cb3" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a tabindex="-1" aria-hidden="true" href="#cb3-1"></a>dat_1_long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pivot_longer</span>(dat_1, <span class="at">cols =</span> <span class="fu">c</span>(Pre, Post), <span class="at">names_to =</span> <span class="st">"Zeitpunkt"</span>,</span>
<span id="cb3-2"><a tabindex="-1" aria-hidden="true" href="#cb3-2"></a><span class="at">values_to =</span> <span class="st">"SP_score"</span>, <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>))</span>
<span id="cb3-3"><a tabindex="-1" aria-hidden="true" href="#cb3-3"></a>dat_1_long<span class="sc">$</span>Zeitpunkt <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat_1_long<span class="sc">$</span>Zeitpunkt)</span>
<span id="cb3-4"><a tabindex="-1" aria-hidden="true" href="#cb3-4"></a>dat_1_long<span class="sc">$</span>Zeitpunkt <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_1_long<span class="sc">$</span>Zeitpunkt, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>, <span class="st">"Post"</span>)) </span>
<span id="cb3-5"><a tabindex="-1" aria-hidden="true" href="#cb3-5"></a>dat_1_long<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat_1_long<span class="sc">$</span>ID)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="level2" id="visuelle-analyse">
<h2 data-anchor-id="visuelle-analyse" class="anchored">Visuelle Analyse</h2>
<div class="cell">
<div id="cb4" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a tabindex="-1" aria-hidden="true" href="#cb4-1"></a><span class="co"># Soziale Phobie als Kriterium/outcome</span></span>
<span id="cb4-2"><a tabindex="-1" aria-hidden="true" href="#cb4-2"></a></span>
<span id="cb4-3"><a tabindex="-1" aria-hidden="true" href="#cb4-3"></a><span class="fu">print</span>(<span class="fu">ggplot</span>(dat_1_long, <span class="fu">aes</span>(<span class="at">x=</span>Zeitpunkt, <span class="at">y=</span>SP_score)) <span class="sc">+</span> </span>
<span id="cb4-4"><a tabindex="-1" aria-hidden="true" href="#cb4-4"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb4-5"><a tabindex="-1" aria-hidden="true" href="#cb4-5"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a tabindex="-1" aria-hidden="true" href="#cb4-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Gruppe)<span class="sc">+</span></span>
<span id="cb4-7"><a tabindex="-1" aria-hidden="true" href="#cb4-7"></a>  <span class="fu">ylab</span>(<span class="st">"Score Soziale Phobie"</span>) <span class="sc">+</span> </span>
<span id="cb4-8"><a tabindex="-1" aria-hidden="true" href="#cb4-8"></a>  <span class="fu">xlab</span>(<span class="st">"Zeitpunkt"</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a tabindex="-1" aria-hidden="true" href="#cb4-9"></a>  <span class="fu">ggtitle</span>(<span class="st">"Veränderung Soziale Phobie Prä zu Post"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_3_files/figure-html/unnamed-chunk-8-1.png"></p>
</div>
<div id="cb5" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a tabindex="-1" aria-hidden="true" href="#cb5-1"></a><span class="fu">print</span>(<span class="fu">ggplot</span>(dat_1_long, <span class="fu">aes</span>(<span class="at">x=</span>Zeitpunkt, <span class="at">y=</span>SP_score, <span class="at">group =</span> ID)) <span class="sc">+</span> </span>
<span id="cb5-2"><a tabindex="-1" aria-hidden="true" href="#cb5-2"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Gruppe)<span class="sc">+</span></span>
<span id="cb5-3"><a tabindex="-1" aria-hidden="true" href="#cb5-3"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span> ID), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a tabindex="-1" aria-hidden="true" href="#cb5-4"></a>  <span class="fu">ylab</span>(<span class="st">"Score Soziale Phobie"</span>) <span class="sc">+</span> </span>
<span id="cb5-5"><a tabindex="-1" aria-hidden="true" href="#cb5-5"></a>  <span class="fu">xlab</span>(<span class="st">"Zeitpunkt"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a tabindex="-1" aria-hidden="true" href="#cb5-6"></a>  <span class="fu">ggtitle</span>(<span class="st">"Veränderung Soziale Phobie Prä zu Post"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_3_files/figure-html/unnamed-chunk-8-2.png"></p>
</div>
</div>
<section class="level3" id="deskriptive-analyse">
<h3 data-anchor-id="deskriptive-analyse" class="anchored">Deskriptive Analyse</h3>
<div class="cell">
<div id="cb6" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a tabindex="-1" aria-hidden="true" href="#cb6-1"></a>descriptives <span class="ot">&lt;-</span> <span class="fu">describeBy</span>(SP_score <span class="sc">~</span> Zeitpunkt <span class="sc">+</span> Gruppe, <span class="at">mat =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> dat_1_long)</span>
<span id="cb6-2"><a tabindex="-1" aria-hidden="true" href="#cb6-2"></a>descriptives</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          item group1     group2 vars  n  mean       sd median trimmed    mad
SP_score1    1    Pre  in_virtuo    1 50 20.12 3.847289   20.0  20.125 4.4478
SP_score2    2   Post  in_virtuo    1 50 10.46 2.451239   10.0  10.350 2.9652
SP_score3    3    Pre   in_sensu    1 50 20.36 3.578621   20.5  20.225 3.7065
SP_score4    4   Post   in_sensu    1 50 16.16 3.247354   16.0  16.075 4.4478
SP_score5    5    Pre Warteliste    1 50 19.68 3.760373   19.5  19.625 3.7065
SP_score6    6   Post Warteliste    1 50 19.54 3.615217   19.0  19.525 4.4478
          min max range       skew   kurtosis        se
SP_score1  13  28    15 0.01784591 -0.8657982 0.5440888
SP_score2   6  17    11 0.40171741 -0.1101339 0.3466575
SP_score3  14  30    16 0.32116519 -0.1804366 0.5060935
SP_score4  10  24    14 0.28721220 -0.7375049 0.4592452
SP_score5  10  28    18 0.12292023 -0.1102863 0.5317971
SP_score6  12  26    14 0.03625233 -1.0225598 0.5112689</code></pre>
</div>
<div id="cb8" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a tabindex="-1" aria-hidden="true" href="#cb8-1"></a><span class="do">#### Namen der Faktoren in Ergebnimatrix einfuegen</span></span>
<span id="cb8-2"><a tabindex="-1" aria-hidden="true" href="#cb8-2"></a><span class="fu">names</span>(descriptives)[<span class="fu">names</span>(descriptives) <span class="sc">==</span> <span class="st">"group1"</span>] <span class="ot">&lt;-</span> <span class="st">"Zeitpunkt"</span></span>
<span id="cb8-3"><a tabindex="-1" aria-hidden="true" href="#cb8-3"></a><span class="fu">names</span>(descriptives)[<span class="fu">names</span>(descriptives) <span class="sc">==</span> <span class="st">"group2"</span>] <span class="ot">&lt;-</span> <span class="st">"Bedingung"</span></span>
<span id="cb8-4"><a tabindex="-1" aria-hidden="true" href="#cb8-4"></a><span class="do">#### Konfidenzintervall ausrechnen</span></span>
<span id="cb8-5"><a tabindex="-1" aria-hidden="true" href="#cb8-5"></a>descriptives<span class="sc">$</span>ci_95 <span class="ot">&lt;-</span> descriptives<span class="sc">$</span>se<span class="sc">*</span><span class="fl">1.96</span></span>
<span id="cb8-6"><a tabindex="-1" aria-hidden="true" href="#cb8-6"></a></span>
<span id="cb8-7"><a tabindex="-1" aria-hidden="true" href="#cb8-7"></a>descriptives<span class="sc">$</span>Zeitpunkt <span class="ot">&lt;-</span> <span class="fu">factor</span>(descriptives<span class="sc">$</span>Zeitpunkt, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>, <span class="st">"Post"</span>))</span>
<span id="cb8-8"><a tabindex="-1" aria-hidden="true" href="#cb8-8"></a>descriptives<span class="sc">$</span>Bedingung <span class="ot">&lt;-</span> <span class="fu">factor</span>(descriptives<span class="sc">$</span>Bedingung, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"in_virtuo"</span>, <span class="st">"in_sensu"</span>, <span class="st">"Warteliste"</span>))</span>
<span id="cb8-9"><a tabindex="-1" aria-hidden="true" href="#cb8-9"></a></span>
<span id="cb8-10"><a tabindex="-1" aria-hidden="true" href="#cb8-10"></a><span class="do">#### Grafik machen</span></span>
<span id="cb8-11"><a tabindex="-1" aria-hidden="true" href="#cb8-11"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>) <span class="co"># zum Versetzen der Punkte</span></span>
<span id="cb8-12"><a tabindex="-1" aria-hidden="true" href="#cb8-12"></a></span>
<span id="cb8-13"><a tabindex="-1" aria-hidden="true" href="#cb8-13"></a><span class="fu">ggplot</span>(descriptives, <span class="fu">aes</span>(<span class="at">x=</span>Zeitpunkt, <span class="at">y=</span>mean, <span class="at">group =</span> Bedingung)) <span class="sc">+</span> </span>
<span id="cb8-14"><a tabindex="-1" aria-hidden="true" href="#cb8-14"></a>   <span class="fu">geom_errorbar</span>(<span class="at">width=</span>.<span class="dv">2</span>, <span class="fu">aes</span>(<span class="at">ymin=</span>mean<span class="sc">-</span>ci_95, <span class="at">ymax=</span>mean<span class="sc">+</span>ci_95), <span class="at">position =</span> pd) <span class="sc">+</span></span>
<span id="cb8-15"><a tabindex="-1" aria-hidden="true" href="#cb8-15"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Bedingung), <span class="at">size=</span><span class="dv">2</span>, <span class="at">position =</span> pd) <span class="sc">+</span></span>
<span id="cb8-16"><a tabindex="-1" aria-hidden="true" href="#cb8-16"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype=</span>Bedingung, <span class="at">color =</span> Bedingung), <span class="at">position =</span> pd) <span class="sc">+</span></span>
<span id="cb8-17"><a tabindex="-1" aria-hidden="true" href="#cb8-17"></a>    <span class="fu">ggtitle</span>(<span class="st">"Mittelwerte plus/minus 95% Konfidenzintervall"</span>)<span class="sc">+</span></span>
<span id="cb8-18"><a tabindex="-1" aria-hidden="true" href="#cb8-18"></a>    <span class="fu">theme_classic</span>()</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_3_files/figure-html/unnamed-chunk-10-1.png"></p>
</div>
</div>
</section>
</section>
<section class="level2" id="modell-mit-zeitpunkt-als-prädiktor">
<h2 data-anchor-id="modell-mit-zeitpunkt-als-prädiktor" class="anchored">Modell mit Zeitpunkt als Prädiktor</h2>
<p>Behandlung und Zeitpunkt sowie ihre Interaktion sagen Score in sozialer Phobie vorher.</p>
<section class="level3" id="schritt-1-allgemeines-lineares-modell-anpassen">
<h3 data-anchor-id="schritt-1-allgemeines-lineares-modell-anpassen" class="anchored">Schritt 1: Allgemeines lineares Modell anpassen</h3>
<p><strong>ACHTUNG: DAS FOLGENDE IST FALSCH UND DIENT NUR DER VERANSCHAULICHUNG!</strong></p>
<div class="cell">
<div id="cb9" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a tabindex="-1" aria-hidden="true" href="#cb9-1"></a><span class="co"># Modelldefinition</span></span>
<span id="cb9-2"><a tabindex="-1" aria-hidden="true" href="#cb9-2"></a><span class="fu">contrasts</span>(dat_1_long<span class="sc">$</span>Gruppe) <span class="ot">&lt;-</span> <span class="fu">contr.helmert</span>(<span class="dv">3</span>)</span>
<span id="cb9-3"><a tabindex="-1" aria-hidden="true" href="#cb9-3"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(SP_score <span class="sc">~</span> Gruppe <span class="sc">*</span> Zeitpunkt, <span class="at">data =</span> dat_1_long)</span>
<span id="cb9-4"><a tabindex="-1" aria-hidden="true" href="#cb9-4"></a></span>
<span id="cb9-5"><a tabindex="-1" aria-hidden="true" href="#cb9-5"></a><span class="co"># Schaetzung der Parameter</span></span>
<span id="cb9-6"><a tabindex="-1" aria-hidden="true" href="#cb9-6"></a><span class="fu">summary</span>(M1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SP_score ~ Gruppe * Zeitpunkt, data = dat_1_long)

Residuals:
   Min     1Q Median     3Q    Max 
 -9.68  -2.36  -0.26   2.48   9.64 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            20.0533     0.2816  71.210  &lt; 2e-16 ***
Gruppe1                 0.1200     0.3449   0.348    0.728    
Gruppe2                -0.1867     0.1991  -0.937    0.349    
ZeitpunktPost          -4.6667     0.3983 -11.718  &lt; 2e-16 ***
Gruppe1:ZeitpunktPost   2.7300     0.4878   5.597 5.00e-08 ***
Gruppe2:ZeitpunktPost   2.2633     0.2816   8.037 2.25e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.449 on 294 degrees of freedom
Multiple R-squared:  0.5175,    Adjusted R-squared:  0.5093 
F-statistic: 63.07 on 5 and 294 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="cb11" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a tabindex="-1" aria-hidden="true" href="#cb11-1"></a><span class="co"># ANOVA zur Bestimmung der Quadratsummen für die beiden Prädiktoren</span></span>
<span id="cb11-2"><a tabindex="-1" aria-hidden="true" href="#cb11-2"></a><span class="fu">Anova</span>(M1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: SP_score
                 Sum Sq  Df F value    Pr(&gt;F)    
Gruppe            976.9   2  41.060 &lt; 2.2e-16 ***
Zeitpunkt        1633.3   1 137.308 &lt; 2.2e-16 ***
Gruppe:Zeitpunkt 1141.0   2  47.962 &lt; 2.2e-16 ***
Residuals        3497.2 294                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Ungeachtet dem obigen Disclaimer steckt in diesem Code etwas, das wir so in diesem Modul noch nicht hatten. <code>Gruppe * Zeitpunkt</code> bei der Modellaufstellung bedeutet, dass R jeweils die Faktoren Gruppe und Zeitpunkt und ihre Interaktion ins Modell einschließen soll. Dies ist eine Kurzschreibweise für <code>Gruppe + Zeitpunkt + Gruppe:Zeitpunkt</code>.</p>
<p>Bei der Modellaufstellung signalisiert also eigentlich ein Doppelpunkt zwischen zwei Prädiktornamen ihre Interaktion, aber da man so oft Haupt- und Interaktionseffekte einschließen möchte, gibt es die Kurzschreibweise mit dem <code>*</code>.</p>
<p>Bei diesem neuen Modell läuft die Interpretation anders. Da der Zeitpunkt jetzt auch ein Faktor ist, beziehen sich die Koeffizienten nicht mehr auf die Postwerte oder die Veränderung, sondern auf die Prä-Werte. Die Treatment-Parameter <code>Gruppe1</code> und <code>Gruppe2</code> für die Gruppenunterschiede beziehen sich jetzt also auf die Scores zu der Zeit, bei der noch kein Treatment stattgefunden hat. Das erklärt zum Beispiel, warum es hier keine signifikanten Unterschiede gibt.</p>
<p>Wir bekommen nun auch einen Koeffizienten für den Zeitpunkt. Dieser bezieht sich auf den Effekt im Mittel über die Gruppen hinweg. Das liegt daran, dass die Treatmentgruppe kontrastkodiert ist.</p>
<p>Die eigentlichen Gruppenunterschiede stecken jetzt in den Interaktionsparametern, die sich genauso interpretieren lassen, wie wir es von der Kontrastkodierung schon kennen, also bspw. “Wenn es um den Post-Zeitpunkt geht, dann gibt es Unterschiede zwischen Ausprägung x und y im Score”.</p>
</section>
<section class="level3" id="kritisches-problem-des-modells-abhängigkeit-der-messungen-check-3">
<h3 data-anchor-id="kritisches-problem-des-modells-abhängigkeit-der-messungen-check-3" class="anchored">Kritisches Problem des Modells: Abhängigkeit der Messungen (Check 3)</h3>
<div class="cell">
<div id="cb13" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a tabindex="-1" aria-hidden="true" href="#cb13-1"></a><span class="co"># Graphik der Zusammenhänge der Residuen</span></span>
<span id="cb13-2"><a tabindex="-1" aria-hidden="true" href="#cb13-2"></a><span class="fu">acf</span>(M1<span class="sc">$</span>residuals)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_3_files/figure-html/unnamed-chunk-14-1.png"></p>
</div>
<div id="cb14" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a tabindex="-1" aria-hidden="true" href="#cb14-1"></a><span class="co"># Test für Autokorrelation 1.Ordnung</span></span>
<span id="cb14-2"><a tabindex="-1" aria-hidden="true" href="#cb14-2"></a><span class="fu">durbinWatsonTest</span>(M1) <span class="co"># Test für eine Autokorrelation 1.Ordnung</span></span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1       0.3554671      1.280913       0
 Alternative hypothesis: rho != 0</code></pre>
</div>
<div id="cb16" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a tabindex="-1" aria-hidden="true" href="#cb16-1"></a><span class="co"># Korrelation Prä-Post Messung</span></span>
<span id="cb16-2"><a tabindex="-1" aria-hidden="true" href="#cb16-2"></a><span class="fu">cor</span>(dat_1<span class="sc">$</span>Pre, dat_1<span class="sc">$</span>Post)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4564356</code></pre>
</div>
</div>
<p>Der Test auf Autokorrelation wird signifikant, was bedeutet, dass hier eine Autokorrelation vorliegt. Diese Autokorrelation von ca. 0.36 zwigt sich auch im entsprechenden Plot im zweiten Balken (bei lag = 1).</p>
<p>Um diese Autokorrelation zu vermeiden gibt es mehrere Möglichkeiten. Man kann bspw. auf Messwiederholungsvarianzanalysen ausweichen.</p>
</section>
</section>
<section class="level2" id="quick-fix-messwiederholungsvarianzanalyse">
<h2 data-anchor-id="quick-fix-messwiederholungsvarianzanalyse" class="anchored">Quick fix: Messwiederholungsvarianzanalyse</h2>
<div class="cell">
<div id="cb18" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a tabindex="-1" aria-hidden="true" href="#cb18-1"></a><span class="co"># Option 1: Varianzanalyse</span></span>
<span id="cb18-2"><a tabindex="-1" aria-hidden="true" href="#cb18-2"></a><span class="do">## Definition Kontraste</span></span>
<span id="cb18-3"><a tabindex="-1" aria-hidden="true" href="#cb18-3"></a><span class="fu">contrasts</span>(dat_1_long<span class="sc">$</span>Gruppe) <span class="ot">&lt;-</span> <span class="fu">contr.helmert</span>(<span class="dv">3</span>)</span>
<span id="cb18-4"><a tabindex="-1" aria-hidden="true" href="#cb18-4"></a></span>
<span id="cb18-5"><a tabindex="-1" aria-hidden="true" href="#cb18-5"></a><span class="do">## Berechnung Varianzanalyse</span></span>
<span id="cb18-6"><a tabindex="-1" aria-hidden="true" href="#cb18-6"></a>aov_m2 <span class="ot">&lt;-</span> <span class="fu">ezANOVA</span>(dat_1_long, <span class="at">dv=</span>SP_score, <span class="at">wid =</span> ID, <span class="at">within =</span> Zeitpunkt, <span class="at">between =</span> Gruppe,  <span class="at">detailed =</span> <span class="cn">TRUE</span>, <span class="at">return_aov =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-7"><a tabindex="-1" aria-hidden="true" href="#cb18-7"></a>aov_m2</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ANOVA
            Effect DFn DFd       SSn     SSd          F             p p&lt;.05
1      (Intercept)   1 147 94199.520 3065.62 4516.97518 2.942005e-112     *
2           Gruppe   2 147   976.860 3065.62   23.42078  1.480735e-09     *
3        Zeitpunkt   1 147  1633.333  431.62  556.27635  7.975457e-52     *
4 Gruppe:Zeitpunkt   2 147  1141.047  431.62  194.30733  5.335420e-42     *
        ges
1 0.9642031
2 0.2183366
3 0.3183530
4 0.2460061

$aov

Call:
aov(formula = formula(aov_formula), data = data)

Grand Mean: 17.72

Stratum 1: ID

Terms:
                 Gruppe Residuals
Sum of Squares   976.86   3065.62
Deg. of Freedom       2       147

Residual standard error: 4.566679
2 out of 4 effects not estimable
Estimated effects are balanced

Stratum 2: ID:Zeitpunkt

Terms:
                Zeitpunkt Gruppe:Zeitpunkt Residuals
Sum of Squares   1633.333         1141.047   431.620
Deg. of Freedom         1                2       147

Residual standard error: 1.713532
Estimated effects are balanced</code></pre>
</div>
</div>
<p>Hier gibt es aber unter anderem das große Problem, dass die Fähigkeit, gerichtete Zusammenhänge zu testen, verloren geht.</p>
</section>
<section class="level2" id="einfachere-lösung-multilevel-modell">
<h2 data-anchor-id="einfachere-lösung-multilevel-modell" class="anchored">Einfachere Lösung: Multilevel-Modell</h2>
<p>Wir werden das Problem der Autokorrelation zwar erst lösen, wenn wir uns Growth-Models anschauen, aber da wir sie für die Lösung brauchen und es noch mehre Probleme mit dem klassischen ALM bei Messwiederholung gibt, wechseln wir zu Multilevel-Modellen.</p>
<div class="cell">
<div id="cb20" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a tabindex="-1" aria-hidden="true" href="#cb20-1"></a><span class="co"># Definition Modell mit random intercept pro Teilnehmer*in = intercept variiert zwischen den Teilnehmer:innen </span></span>
<span id="cb20-2"><a tabindex="-1" aria-hidden="true" href="#cb20-2"></a>M3 <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(SP_score <span class="sc">~</span> Gruppe <span class="sc">*</span> Zeitpunkt <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">data =</span> dat_1_long)</span>
<span id="cb20-3"><a tabindex="-1" aria-hidden="true" href="#cb20-3"></a></span>
<span id="cb20-4"><a tabindex="-1" aria-hidden="true" href="#cb20-4"></a><span class="co"># Zeigen geschätzte Koeffizienten</span></span>
<span id="cb20-5"><a tabindex="-1" aria-hidden="true" href="#cb20-5"></a><span class="fu">summary</span>(M3)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: SP_score ~ Gruppe * Zeitpunkt + (1 | ID)
   Data: dat_1_long

REML criterion at convergence: 1469.8

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.00405 -0.52070 -0.02507  0.51567  2.23698 

Random effects:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 8.959    2.993   
 Residual             2.936    1.714   
Number of obs: 300, groups:  ID, 150

Fixed effects:
                      Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept)            20.0533     0.2816 187.5888  71.210   &lt;2e-16 ***
Gruppe1                 0.1200     0.3449 187.5888   0.348    0.728    
Gruppe2                -0.1867     0.1991 187.5888  -0.937    0.350    
ZeitpunktPost          -4.6667     0.1979 147.0000 -23.586   &lt;2e-16 ***
Gruppe1:ZeitpunktPost   2.7300     0.2423 147.0000  11.266   &lt;2e-16 ***
Gruppe2:ZeitpunktPost   2.2633     0.1399 147.0000  16.177   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) Grupp1 Grupp2 ZtpnkP Gr1:ZP
Gruppe1      0.000                            
Gruppe2      0.000  0.000                     
ZeitpnktPst -0.351  0.000  0.000              
Grpp1:ZtpnP  0.000 -0.351  0.000  0.000       
Grpp2:ZtpnP  0.000  0.000 -0.351  0.000  0.000</code></pre>
</div>
<div id="cb22" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a tabindex="-1" aria-hidden="true" href="#cb22-1"></a><span class="co"># Signifikanztest für Faktoren</span></span>
<span id="cb22-2"><a tabindex="-1" aria-hidden="true" href="#cb22-2"></a><span class="fu">Anova</span>(M3)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: SP_score
                   Chisq Df Pr(&gt;Chisq)    
Gruppe            46.842  2  6.737e-11 ***
Zeitpunkt        556.276  1  &lt; 2.2e-16 ***
Gruppe:Zeitpunkt 388.615  2  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="cb24" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a tabindex="-1" aria-hidden="true" href="#cb24-1"></a><span class="co"># Geschätzte Mittelwerte</span></span>
<span id="cb24-2"><a tabindex="-1" aria-hidden="true" href="#cb24-2"></a>predmeans <span class="ot">&lt;-</span> <span class="fu">predictmeans</span>(M3, <span class="st">"Gruppe:Zeitpunkt"</span>, <span class="at">adj =</span><span class="st">"BH"</span>, <span class="at">barplot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-3"><a tabindex="-1" aria-hidden="true" href="#cb24-3"></a>predmeans</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Predicted Means`
           Zeitpunkt   Pre  Post
Gruppe                          
in_virtuo            20.12 10.46
in_sensu             20.36 16.16
Warteliste           19.68 19.54

$`Standard Error of Means`
All means have the same Stder 
                      0.48776 

$`Standard Error of Differences`
  Max.SED   Min.SED  Aveg.SED 
0.6897934 0.3427063 0.6203760 
attr(,"For the Same Level of Factor")
            Gruppe Zeitpunkt
Aveg.SED 0.3427063 0.6897934
Min.SED  0.3427063 0.6897934
Max.SED  0.3427063 0.6897934

$LSD
 Max.LSD  Min.LSD Aveg.LSD 
 1.36319  0.67727  1.22601 
attr(,"For the Same Level of Factor")
          Gruppe Zeitpunkt
Aveg.LSD 0.67727   1.36319
Min.LSD  0.67727   1.36319
Max.LSD  0.67727   1.36319
attr(,"Significant level")
[1] 0.05
attr(,"Degree of freedom")
[1] 147

$`Pairwise p-value`
                in_virtuo:Pre in_virtuo:Post in_sensu:Pre in_sensu:Post
in_virtuo:Pre          0.0000        28.1874      -0.3479        5.7408
in_virtuo:Post         0.0000         0.0000     -14.3521       -8.2633
in_sensu:Pre           0.7284         0.0000       0.0000       12.2554
in_sensu:Post          0.0000         0.0000       0.0000        0.0000
Warteliste:Pre         0.6052         0.0000       0.4443        0.0000
Warteliste:Post        0.5023         0.0000       0.3547        0.0000
                Warteliste:Pre Warteliste:Post
in_virtuo:Pre           0.6379          0.8408
in_virtuo:Post        -13.3663        -13.1634
in_sensu:Pre            0.9858          1.1888
in_sensu:Post          -5.1030         -4.9000
Warteliste:Pre          0.0000          0.4085
Warteliste:Post         0.7284          0.0000
attr(,"Degree of freedom")
[1] 147
attr(,"Note")
[1] "The matrix has t-value above the diagonal, p-value (adjusted by 'BH' method) below the diagonal"
attr(,"Letter-based representation of pairwise comparisons at significant level '0.05'")
        Treatment  Mean Group
1    in_sensu:Pre 20.36   A  
2   in_virtuo:Pre 20.12   A  
3  Warteliste:Pre 19.68   A  
4 Warteliste:Post 19.54   A  
5   in_sensu:Post 16.16    B 
6  in_virtuo:Post 10.46     C

$mean_table
      Gruppe Zeitpunkt Predicted means Standard error  Df LL of 95% CI
1  in_virtuo       Pre           20.12      0.4877576 147    19.156077
2  in_virtuo      Post           10.46      0.4877576 147     9.496077
3   in_sensu       Pre           20.36      0.4877576 147    19.396077
4   in_sensu      Post           16.16      0.4877576 147    15.196077
5 Warteliste       Pre           19.68      0.4877576 147    18.716077
6 Warteliste      Post           19.54      0.4877576 147    18.576077
  UL of 95% CI LetterGrp
1     21.08392       A  
2     11.42392        B 
3     21.32392       A  
4     17.12392         C
5     20.64392       A  
6     20.50392       A  </code></pre>
</div>
</div>
<div class="cell">
<div id="cb26" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a tabindex="-1" aria-hidden="true" href="#cb26-1"></a>predmeans<span class="sc">$</span>predictmeansBarPlot</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_3_files/figure-html/unnamed-chunk-20-1.png"></p>
</div>
</div>
<p>Ein überzeugendes Argument für die Nutzung dieser Modelle ist die Möglichkeit, einzubauen, dass es individuelle Unterschiede in bestimmten Aspekten des Modells gibt. So drücken wir mit dem Term <code>(1|ID)</code> aus, dass der Intercept zwischen Personen variiert. Das bedeutet auf deutsch, dass wir die ziemlich realistische Annahme zulassen, dass sich verschiedene Personen in ihrer Präbelastung unterscheiden. Es ließe sich mit diesen Modellen sogar testen, ob variable oder feste Intercepts die Datenlage besser beschreiben, aber das wollen wir hier erstmal nicht tun.</p>
<p>Die Interpretation läuft analog zum normalen ALM, wobei wir zusätzlich eine Schätzung für die Varianz der Intercepts bekommen, die wir zusätzlich interpretieren können.</p>
<section class="level3" id="check-2-prüfung-der-residuen">
<h3 data-anchor-id="check-2-prüfung-der-residuen" class="anchored">Check 2: Prüfung der Residuen</h3>
<div class="cell">
<div id="cb27" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a tabindex="-1" aria-hidden="true" href="#cb27-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb27-2"><a tabindex="-1" aria-hidden="true" href="#cb27-2"></a><span class="co"># Das gleiche Modell nur mit einem anderen Paket gemacht</span></span>
<span id="cb27-3"><a tabindex="-1" aria-hidden="true" href="#cb27-3"></a>M4 <span class="ot">&lt;-</span> <span class="fu">lme</span>(SP_score <span class="sc">~</span> Gruppe <span class="sc">*</span> Zeitpunkt, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>ID, <span class="at">data =</span> dat_1_long)</span>
<span id="cb27-4"><a tabindex="-1" aria-hidden="true" href="#cb27-4"></a><span class="fu">summary</span>(M4)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: dat_1_long 
       AIC      BIC    logLik
  1485.834 1515.302 -734.9169

Random effects:
 Formula: ~1 | ID
        (Intercept) Residual
StdDev:    2.993191 1.713531

Fixed effects:  SP_score ~ Gruppe * Zeitpunkt 
                          Value Std.Error  DF   t-value p-value
(Intercept)           20.053333 0.2816071 147  71.21033  0.0000
Gruppe1                0.120000 0.3448968 147   0.34793  0.7284
Gruppe2               -0.186667 0.1991263 147  -0.93743  0.3501
ZeitpunktPost         -4.666667 0.1978615 147 -23.58552  0.0000
Gruppe1:ZeitpunktPost  2.730000 0.2423299 147  11.26564  0.0000
Gruppe2:ZeitpunktPost  2.263333 0.1399092 147  16.17716  0.0000
 Correlation: 
                      (Intr) Grupp1 Grupp2 ZtpnkP Gr1:ZP
Gruppe1                0.000                            
Gruppe2                0.000  0.000                     
ZeitpunktPost         -0.351  0.000  0.000              
Gruppe1:ZeitpunktPost  0.000 -0.351  0.000  0.000       
Gruppe2:ZeitpunktPost  0.000  0.000 -0.351  0.000  0.000

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.00405142 -0.52070266 -0.02507123  0.51566764  2.23698172 

Number of Observations: 300
Number of Groups: 150 </code></pre>
</div>
<div id="cb29" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a tabindex="-1" aria-hidden="true" href="#cb29-1"></a><span class="co"># Residuen</span></span>
<span id="cb29-2"><a tabindex="-1" aria-hidden="true" href="#cb29-2"></a><span class="fu">densityplot</span>(<span class="fu">residuals</span>(M4, <span class="at">type =</span> <span class="st">"normalized"</span>))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_3_files/figure-html/unnamed-chunk-22-1.png"></p>
</div>
<div id="cb30" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a tabindex="-1" aria-hidden="true" href="#cb30-1"></a><span class="do">## Normalisierung ist wichtig, damit Abhängigkeiten richtig berücksichtigt werden</span></span>
<span id="cb30-2"><a tabindex="-1" aria-hidden="true" href="#cb30-2"></a></span>
<span id="cb30-3"><a tabindex="-1" aria-hidden="true" href="#cb30-3"></a><span class="co"># Abspeichern der Residuen und fitted values in Vektoren</span></span>
<span id="cb30-4"><a tabindex="-1" aria-hidden="true" href="#cb30-4"></a>res.vec <span class="ot">&lt;-</span> <span class="fu">residuals</span>(M4, <span class="at">type =</span> <span class="st">"normalized"</span>)</span>
<span id="cb30-5"><a tabindex="-1" aria-hidden="true" href="#cb30-5"></a>fit.vec <span class="ot">&lt;-</span> M4<span class="sc">$</span>fitted[,<span class="dv">1</span>]</span>
<span id="cb30-6"><a tabindex="-1" aria-hidden="true" href="#cb30-6"></a></span>
<span id="cb30-7"><a tabindex="-1" aria-hidden="true" href="#cb30-7"></a><span class="co"># Scatterplot machen</span></span>
<span id="cb30-8"><a tabindex="-1" aria-hidden="true" href="#cb30-8"></a><span class="fu">scatterplot</span>(res.vec <span class="sc">~</span> fit.vec)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_3_files/figure-html/unnamed-chunk-22-2.png"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script type="application/javascript" id="quarto-html-after-body">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="1_ALM_3_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>