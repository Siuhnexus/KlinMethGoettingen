<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bente Hinkenhuis">
<meta name="dcterms.date" content="2023-09-11">

<title>Structural Equation Modelling (SEM)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="10_SEM_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="10_SEM_2_files/libs/quarto-html/quarto.js"></script>
<script src="10_SEM_2_files/libs/quarto-html/popper.min.js"></script>
<script src="10_SEM_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="10_SEM_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="10_SEM_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="10_SEM_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="10_SEM_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="10_SEM_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="10_SEM_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>
<script src="10_SEM_2_files/libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="10_SEM_2_files/libs/viz-1.8.2/viz.js"></script>
<link href="10_SEM_2_files/libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="10_SEM_2_files/libs/grViz-binding-1.0.10/grViz.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../style.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#structural-equation-modelling-sem---cross-legged-panel-models" id="toc-structural-equation-modelling-sem---cross-legged-panel-models" class="nav-link active" data-scroll-target="#structural-equation-modelling-sem---cross-legged-panel-models">Structural Equation Modelling (SEM) - Cross-Legged Panel Models</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Structural Equation Modelling (SEM)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bente Hinkenhuis </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">root.dir =</span> <span class="st">'../'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="structural-equation-modelling-sem---cross-legged-panel-models" class="level1">
<h1>Structural Equation Modelling (SEM) - Cross-Legged Panel Models</h1>
<p>Heute arbeiten wir mit Cross-Legged Panel Models und verstehen dabei, wie sich aus korrelativen Daten differenzieren lässt, welche Variable wie auf welche andere Variable im zeitlichen Verlauf wirkt. Dazu laden wir erstmal alles nötige.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-16
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Sitzungen/SEMgraph.R"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"Sitzungen/SleepMWBScored.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wie beim untersuchen des Datensatzes ersichtlich wird, gibt es hier keine Indikatoren mehr, sondern nur noch die beiden latenten Variablen zu vier Zeitpunkten. Es handelt sich hier nicht mehr um gemessene Variablen, sondern um Faktor-Scores, die sich aus den Ladungen errechnen lassen. Dies dient einfach nur dazu, das Modell nicht zu komplex werden zu lassen und den Fokus dieser Sitzung auf den CLPM zu halten.</p>
<p>Prinzipiell gibt es bei CLPMs zwei wichtige Komponenten; die Autoregression und die gekreuzten Effekte (auch Kreuzkorrelationen oder Kreuzregression genannt). Jede Variable zum Zeitpunkt <span class="math inline">\(t\)</span> wirkt also auf sich selbst zu Zeitpunkt <span class="math inline">\(t+1\)</span> und auf die jeweils andere Variable zum Zeitpunkt <span class="math inline">\(t+1\)</span>. Zum Verständnis gibt es weiter unten aber auch wieder eine Abbildung zum Modell.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>clpm <span class="ot">=</span> <span class="st">'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="st"># 1. Latente Variablen</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">sleep1 =~ fssleep1</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 =~ fssleep2</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 =~ fssleep3</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 =~ fssleep4</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">mwb1 =~ fsmwb1</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">mwb2 =~ fsmwb2</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">mwb3 =~ fsmwb3</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">mwb4 =~ fsmwb4</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st"># 1. Autoregression</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 ~ a1 * sleep1</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 ~ a1 * sleep2</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 ~ a1 * sleep3</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="st">mwb2 ~ a2 * mwb1</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="st">mwb3 ~ a2 * mwb2</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="st">mwb4 ~ a2 * mwb3</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="st"># 2. Kreuzregression</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="st">mwb2 ~ c1 * sleep1</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="st">mwb3 ~ c1 * sleep2</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="st">mwb4 ~ c1 * sleep3</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 ~ c2 * mwb1</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 ~ c2 * mwb2</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 ~ c2 * mwb3</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="st"># 3. Kovarianzen</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="st">sleep1 ~~ cov1 * mwb1</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 ~~ cov2 * mwb2</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 ~~ cov2 * mwb3</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 ~~ cov2 * mwb4</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="st"># 4. Intercepts</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep1 ~ 0 * 1</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep2 ~ 0 * 1</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep3 ~ 0 * 1</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep4 ~ 0 * 1</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb1 ~ 0 * 1</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb2 ~ 0 * 1</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb3 ~ 0 * 1</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb4 ~ 0 * 1</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>clpmfit <span class="ot">=</span> <span class="fu">sem</span>(clpm, dat)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(clpmfit, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 47 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        24
  Number of equality constraints                    10

  Number of observations                          2837

Model Test User Model:
                                                      
  Test statistic                              3736.597
  Degrees of freedom                                30
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                             23164.810
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.840
  Tucker-Lewis Index (TLI)                       0.850

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -33935.144
  Loglikelihood unrestricted model (H1)     -32066.846
                                                      
  Akaike (AIC)                               67898.288
  Bayesian (BIC)                             67981.595
  Sample-size adjusted Bayesian (SABIC)      67937.112

Root Mean Square Error of Approximation:

  RMSEA                                          0.209
  90 Percent confidence interval - lower         0.203
  90 Percent confidence interval - upper         0.214
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.471

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  sleep1 =~                                           
    fssleep1          1.000                           
  sleep2 =~                                           
    fssleep2          1.000                           
  sleep3 =~                                           
    fssleep3          1.000                           
  sleep4 =~                                           
    fssleep4          1.000                           
  mwb1 =~                                             
    fsmwb1            1.000                           
  mwb2 =~                                             
    fsmwb2            1.000                           
  mwb3 =~                                             
    fsmwb3            1.000                           
  mwb4 =~                                             
    fsmwb4            1.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  sleep2 ~                                            
    sleep1    (a1)    0.782    0.006  120.461    0.000
  sleep3 ~                                            
    sleep2    (a1)    0.782    0.006  120.461    0.000
  sleep4 ~                                            
    sleep3    (a1)    0.782    0.006  120.461    0.000
  mwb2 ~                                              
    mwb1      (a2)    0.604    0.009   65.684    0.000
  mwb3 ~                                              
    mwb2      (a2)    0.604    0.009   65.684    0.000
  mwb4 ~                                              
    mwb3      (a2)    0.604    0.009   65.684    0.000
  mwb2 ~                                              
    sleep1    (c1)    0.230    0.006   36.195    0.000
  mwb3 ~                                              
    sleep2    (c1)    0.230    0.006   36.195    0.000
  mwb4 ~                                              
    sleep3    (c1)    0.230    0.006   36.195    0.000
  sleep2 ~                                            
    mwb1      (c2)    0.573    0.009   60.776    0.000
  sleep3 ~                                            
    mwb2      (c2)    0.573    0.009   60.776    0.000
  sleep4 ~                                            
    mwb3      (c2)    0.573    0.009   60.776    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  sleep1 ~~                                           
    mwb1    (cov1)    1.531    0.056   27.481    0.000
 .sleep2 ~~                                           
   .mwb2    (cov2)    0.082    0.010    7.848    0.000
 .sleep3 ~~                                           
   .mwb3    (cov2)    0.082    0.010    7.848    0.000
 .sleep4 ~~                                           
   .mwb4    (cov2)    0.082    0.010    7.848    0.000

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .fssleep1          0.000                           
   .fssleep2          0.000                           
   .fssleep3          0.000                           
   .fssleep4          0.000                           
   .fsmwb1            0.000                           
   .fsmwb2            0.000                           
   .fsmwb3            0.000                           
   .fsmwb4            0.000                           
    sleep1            0.000                           
   .sleep2            0.000                           
   .sleep3            0.000                           
   .sleep4            0.000                           
    mwb1              0.000                           
   .mwb2              0.000                           
   .mwb3              0.000                           
   .mwb4              0.000                           

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .fssleep1          0.000                           
   .fssleep2          0.000                           
   .fssleep3          0.000                           
   .fssleep4          0.000                           
   .fsmwb1            0.000                           
   .fsmwb2            0.000                           
   .fsmwb3            0.000                           
   .fsmwb4            0.000                           
    sleep1            3.044    0.081   37.663    0.000
   .sleep2            1.175    0.031   37.821    0.000
   .sleep3            0.896    0.024   37.854    0.000
   .sleep4            0.947    0.025   37.856    0.000
    mwb1              2.122    0.056   37.663    0.000
   .mwb2              1.024    0.027   37.821    0.000
   .mwb3              0.946    0.025   37.854    0.000
   .mwb4              0.871    0.023   37.856    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SEMgraph</span>(clpmfit, <span class="at">showPar=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-ed08e2cb5b6b8a76be87" style="width:100%;height:464px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed08e2cb5b6b8a76be87">{"x":{"diagram":"digraph{node[penwidth=2];node[shape=box]node[shape=circle];sleep2;sleep3;sleep4;mwb2;mwb3;mwb4;sleep1;mwb1;edge[minlen=2,constraint=true];edge[constraint=true];sleep1->sleep2[label=\" a1\"];sleep2->sleep3[label=\" a1\"];sleep3->sleep4[label=\" a1\"];mwb1->mwb2[label=\" a2\"];mwb2->mwb3[label=\" a2\"];mwb3->mwb4[label=\" a2\"];sleep1->mwb2[label=\" c1\"];sleep2->mwb3[label=\" c1\"];sleep3->mwb4[label=\" c1\"];mwb1->sleep2[label=\" c2\"];mwb2->sleep3[label=\" c2\"];mwb3->sleep4[label=\" c2\"];edge[dir=back];edge[dir=both,constraint=false];mwb1->sleep1[label=\" cov1\"];mwb2->sleep2[label=\" cov2\"];mwb3->sleep3[label=\" cov2\"];mwb4->sleep4[label=\" cov2\"];}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Für dieses Modell haben wir eine Syntax gebraucht, die uns noch unbekannt ist:</p>
<ul>
<li>Schreiben wir einen Zahlenwert vor einen Parameter, wird dieser auf den angegebenen Zahlenwert <strong>fixiert</strong>.</li>
</ul>
<p>Dies nutzen wir bei den Intercepts für die Variablen aus dem Datensatz aus, um diese Variablen (die von <code>lavaan</code> als gemessen behandelt werden, obwohl wir sie ja nicht gemessen, sondern als Faktor-Scores aus gemessenen Indikatoren berechnet haben) in latente Variablen umzuwandeln. Bspw. führen die beiden Zeilen <code>sleep1 =~ fssleep1</code> und <code>fssleep1 ~ 0 * 1</code> dazu, dass <code>sleep1</code> die Werte von <code>fssleep1</code> annimmt, intern aber trotzdem als latente Variable behandelt wird.</p>
<p>Obwohl wir beeindruckend hohe Parameter für die Auto- und Kreuzregressionen sehen, sollten wir vorsichtig sein. Die Fitstatistiken sprechen nämlich alle gegen dieses Modell. Das kann viele Gründe haben; vielleicht sollten wir die Kovarianzen zwischen den Variablen ab Zeitpunkt 2 nicht gleichsetzen. Vielleicht sollten wir aber auch noch manche Varianzen gleichsetzen. Es gäbe viele Möglichkeiten, von hier aus weiterzuarbeiten. In dieser Sitzung wählen wir eine, die nebenbei auch noch ein grundsätzliches konzeptuelles Problem an CLPMs offenlegt.</p>
<p>Momentan trennen wir noch nicht zwischen Effekten within- und between-subjects. Die Varianz, die dadurch zustande kommt, dass manche Leute einfach grundsätzlich (über die Zeit stabil) länger schlafen als andere und manche ein grundlegend geringeres psychisches Wohlbefinden haben als andere, verteilt sich momentan gemeinsam mit den Entwicklungen einzelner Personen über die Zeit hinweg auf die Auto- und Kreuzregressionsparameter. Wir können aber dafür sorgen, dass das nicht mehr geschieht, indem wir pro Variable eine weitere latente Variable in das Modell einbringen.</p>
<p>Dieses Vorgehen ähnelt dem, was wir am Ende der letzten Sitzung gemacht haben. Dort haben wir mit einer weiteren latenten Variable die gemeinsame Varianz der 4 latenten Variablen des jeweiligen Konstrukts “herausgezogen”. Statistisch gesehen ist das so, als ob wir für jede Person einen Mittelwert pro Konstrukt über die Zeit hinweg bilden und die Werte dieser Person anhand ihres Mittelwertes zentrieren. So bleiben nur die Veränderungen der Personen über die Zeit übrig.</p>
<p>Das Modell entwickelt sich so zu einem Modell mit Random Intercept für jede Person. Deshalb heißt diese neue Modellklasse Cross-Legged Panel Model with Random Intercept (CLPM-RI).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>clpmri <span class="ot">=</span> <span class="st">'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st"># 1. Latente Variablen</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">sleep1 =~ 1 * fssleep1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 =~ 1 * fssleep2</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 =~ 1 * fssleep3</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 =~ 1 * fssleep4</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">mwb1 =~ 1 * fsmwb1</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">mwb2 =~ 1 * fsmwb2</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">mwb3 =~ 1 * fsmwb3</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">mwb4 =~ 1 * fsmwb4</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">isleep =~ 1 * sleep1 + 1 * sleep2 + 1 * sleep3 + 1 * sleep4</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">imwb =~ 1 * mwb1 + 1 * mwb2 + 1 * mwb3 + 1 * mwb4</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st"># 2. Autoregression</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 ~ a1 * sleep1</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 ~ a1 * sleep2</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 ~ a1 * sleep3</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">mwb2 ~ a2 * mwb1</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">mwb3 ~ a2 * mwb2</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">mwb4 ~ a2 * mwb3</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st"># 3. Kreuzregression</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">mwb2 ~ c1 * sleep1</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">mwb3 ~ c1 * sleep2</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st">mwb4 ~ c1 * sleep3</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 ~ c2 * mwb1</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 ~ c2 * mwb2</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 ~ c2 * mwb3</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="st"># 4. Kovarianzen</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">sleep1 ~~ cov1 * mwb1</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="st">sleep2 ~~ cov2 * mwb2</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="st">sleep3 ~~ cov2 * mwb3</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="st">sleep4 ~~ cov2 * mwb4</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="st">isleep ~~ covi*imwb</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="st">sleep1 ~~ 0 * isleep</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="st">mwb1 ~~ 0 * isleep</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="st">sleep1 ~~ 0 * imwb</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="st">mwb1 ~~ 0 * imwb</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="st"># 5. Intercepts</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep1 ~ 0 * 1</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep2 ~ 0 * 1</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep3 ~ 0 * 1</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="st">fssleep4 ~ 0 * 1</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb1 ~ 0 * 1</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb2 ~ 0 * 1</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb3 ~ 0 * 1</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="st">fsmwb4 ~ 0 * 1</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="st">isleep ~ 1</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="st">imwb ~ 1</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>clpmrifit <span class="ot">=</span> <span class="fu">sem</span>(clpmri, dat)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(clpmrifit, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 44 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        29
  Number of equality constraints                    10

  Number of observations                          2837

Model Test User Model:
                                                      
  Test statistic                                79.498
  Degrees of freedom                                25
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                             23164.810
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.998
  Tucker-Lewis Index (TLI)                       0.997

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -32106.595
  Loglikelihood unrestricted model (H1)     -32066.846
                                                      
  Akaike (AIC)                               64251.190
  Bayesian (BIC)                             64364.249
  Sample-size adjusted Bayesian (SABIC)      64303.880

Root Mean Square Error of Approximation:

  RMSEA                                          0.028
  90 Percent confidence interval - lower         0.021
  90 Percent confidence interval - upper         0.035
  P-value H_0: RMSEA &lt;= 0.050                    1.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.011

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  sleep1 =~                                           
    fssleep1          1.000                           
  sleep2 =~                                           
    fssleep2          1.000                           
  sleep3 =~                                           
    fssleep3          1.000                           
  sleep4 =~                                           
    fssleep4          1.000                           
  mwb1 =~                                             
    fsmwb1            1.000                           
  mwb2 =~                                             
    fsmwb2            1.000                           
  mwb3 =~                                             
    fsmwb3            1.000                           
  mwb4 =~                                             
    fsmwb4            1.000                           
  isleep =~                                           
    sleep1            1.000                           
    sleep2            1.000                           
    sleep3            1.000                           
    sleep4            1.000                           
  imwb =~                                             
    mwb1              1.000                           
    mwb2              1.000                           
    mwb3              1.000                           
    mwb4              1.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  sleep2 ~                                            
    sleep1    (a1)    0.276    0.008   34.621    0.000
  sleep3 ~                                            
    sleep2    (a1)    0.276    0.008   34.621    0.000
  sleep4 ~                                            
    sleep3    (a1)    0.276    0.008   34.621    0.000
  mwb2 ~                                              
    mwb1      (a2)    0.126    0.012   10.395    0.000
  mwb3 ~                                              
    mwb2      (a2)    0.126    0.012   10.395    0.000
  mwb4 ~                                              
    mwb3      (a2)    0.126    0.012   10.395    0.000
  mwb2 ~                                              
    sleep1    (c1)    0.099    0.008   13.139    0.000
  mwb3 ~                                              
    sleep2    (c1)    0.099    0.008   13.139    0.000
  mwb4 ~                                              
    sleep3    (c1)    0.099    0.008   13.139    0.000
  sleep2 ~                                            
    mwb1      (c2)    0.536    0.011   50.016    0.000
  sleep3 ~                                            
    mwb2      (c2)    0.536    0.011   50.016    0.000
  sleep4 ~                                            
    mwb3      (c2)    0.536    0.011   50.016    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
 .sleep1 ~~                                           
   .mwb1    (cov1)    0.172    0.018    9.647    0.000
 .sleep2 ~~                                           
   .mwb2    (cov2)    0.019    0.008    2.333    0.020
 .sleep3 ~~                                           
   .mwb3    (cov2)    0.019    0.008    2.333    0.020
 .sleep4 ~~                                           
   .mwb4    (cov2)    0.019    0.008    2.333    0.020
  isleep ~~                                           
    imwb    (covi)    0.601    0.030   20.299    0.000
 .sleep1 ~~                                           
    isleep            0.000                           
 .mwb1 ~~                                             
    isleep            0.000                           
 .sleep1 ~~                                           
    imwb              0.000                           
 .mwb1 ~~                                             
    imwb              0.000                           

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .fssleep1          0.000                           
   .fssleep2          0.000                           
   .fssleep3          0.000                           
   .fssleep4          0.000                           
   .fsmwb1            0.000                           
   .fsmwb2            0.000                           
   .fsmwb3            0.000                           
   .fsmwb4            0.000                           
    isleep            1.084    0.022   48.686    0.000
    imwb              0.640    0.022   29.274    0.000
   .sleep1            0.000                           
   .sleep2            0.000                           
   .sleep3            0.000                           
   .sleep4            0.000                           
   .mwb1              0.000                           
   .mwb2              0.000                           
   .mwb3              0.000                           
   .mwb4              0.000                           

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .fssleep1          0.000                           
   .fssleep2          0.000                           
   .fssleep3          0.000                           
   .fssleep4          0.000                           
   .fsmwb1            0.000                           
   .fsmwb2            0.000                           
   .fsmwb3            0.000                           
   .fsmwb4            0.000                           
   .sleep1            0.817    0.026   30.945    0.000
   .sleep2            0.526    0.019   27.823    0.000
   .sleep3            0.536    0.019   28.333    0.000
   .sleep4            0.607    0.020   29.764    0.000
   .mwb1              0.665    0.023   29.116    0.000
   .mwb2              0.673    0.023   29.323    0.000
   .mwb3              0.621    0.022   28.666    0.000
   .mwb4              0.623    0.021   29.584    0.000
    isleep            1.011    0.037   27.449    0.000
    imwb              1.001    0.038   26.380    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SEMgraph</span>(clpmrifit, <span class="at">showPar=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-f63a4ad2ed08843c6983" style="width:100%;height:464px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-f63a4ad2ed08843c6983">{"x":{"diagram":"digraph{node[penwidth=2];subgraph{rank=source;node[shape=triangle];1;}node[shape=box]node[shape=circle];isleep;imwb;sleep2;sleep3;sleep4;mwb2;mwb3;mwb4;sleep1;mwb1;edge[minlen=2,constraint=true];1->isleep;1->imwb;edge[constraint=true];sleep1->sleep2[label=\" a1\"];sleep2->sleep3[label=\" a1\"];sleep3->sleep4[label=\" a1\"];mwb1->mwb2[label=\" a2\"];mwb2->mwb3[label=\" a2\"];mwb3->mwb4[label=\" a2\"];sleep1->mwb2[label=\" c1\"];sleep2->mwb3[label=\" c1\"];sleep3->mwb4[label=\" c1\"];mwb1->sleep2[label=\" c2\"];mwb2->sleep3[label=\" c2\"];mwb3->sleep4[label=\" c2\"];edge[dir=back];sleep1->isleep[label=\" \"];sleep2->isleep[label=\" \"];sleep3->isleep[label=\" \"];sleep4->isleep[label=\" \"];mwb1->imwb[label=\" \"];mwb2->imwb[label=\" \"];mwb3->imwb[label=\" \"];mwb4->imwb[label=\" \"];edge[dir=both,constraint=false];mwb1->sleep1[label=\" cov1\"];mwb2->sleep2[label=\" cov2\"];mwb3->sleep3[label=\" cov2\"];mwb4->sleep4[label=\" cov2\"];imwb->isleep[label=\" covi\"];}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Die Änderung schlägt sich in den Estimates wieder; die Auto- und Kreuzregressionen sind deutlich kleiner. Auch die Interpretation dieser Parameter hat sich dahingehend verändert, dass sie sich nur noch auf die Entwicklungen within-subjects beziehen. Die between-subjects Effekte finden sich in der Kovarianz zwischen den beiden Intercept-Faktoren wieder. Es scheint eine starke, positive Assoziation zwischen der durchschnittlichen Schlafmenge über die Zeit hinweg und dem durchschnittlichen mentalen Wohlbefinden über die Zeit hinweg zu geben.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="10_SEM_2_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>