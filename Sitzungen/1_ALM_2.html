<!DOCTYPE html>
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml"><head>

<meta charset="utf-8">
<meta content="quarto-1.3.340" name="generator">

<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport">

<meta content="YH" name="author">
<meta content="2022-05-16" name="dcterms.date">

<title>Datenanalyse ALM - Kontraste</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="1_ALM_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="1_ALM_2_files/libs/quarto-html/quarto.js"></script>
<script src="1_ALM_2_files/libs/quarto-html/popper.min.js"></script>
<script src="1_ALM_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="1_ALM_2_files/libs/quarto-html/anchor.min.js"></script>
<link rel="stylesheet" href="1_ALM_2_files/libs/quarto-html/tippy.css">
<link id="quarto-text-highlighting-styles" rel="stylesheet" href="1_ALM_2_files/libs/quarto-html/quarto-syntax-highlighting.css">
<script src="1_ALM_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link rel="stylesheet" href="1_ALM_2_files/libs/bootstrap/bootstrap-icons.css">
<link data-mode="light" id="quarto-bootstrap" rel="stylesheet" href="1_ALM_2_files/libs/bootstrap/bootstrap.min.css">
<style>html{ scroll-behavior: smooth; }</style>


<link href="../style.css" rel="stylesheet">
</head>

<body><div class="header"><div class="nav-item"><a href="../Sitzungen/">Sitzungen</a><div class="nav-list"><div class="nav-item"><a href="../Sitzungen/1_ALM_1.html">1_ALM_1</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_1_L.html">1_ALM_1_L</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_2.html">1_ALM_2</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_3.html">1_ALM_3</a></div><div class="nav-item"><a href="../Sitzungen/1_ALM_4.html">1_ALM_4</a></div></div></div><div class="nav-item"><a href="../Vorkurs/">Vorkurs</a><div class="nav-list"><div class="nav-item"><a href="../Vorkurs/Sitzung1.html">Sitzung1</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung2.html">Sitzung2</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung3.html">Sitzung3</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung4.html">Sitzung4</a></div><div class="nav-item"><a href="../Vorkurs/Sitzung5.html">Sitzung5</a></div></div></div></div>

<div class="page-columns page-rows-contents page-layout-article" id="quarto-content">
<div class="sidebar margin-sidebar" id="quarto-margin-sidebar">
  <nav class="toc-active" role="doc-toc" id="TOC">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a data-scroll-target="#allgemeines-lineares-modell-2---kontraste" class="nav-link active" id="toc-allgemeines-lineares-modell-2---kontraste" href="#allgemeines-lineares-modell-2---kontraste">Allgemeines Lineares Modell 2 - Kontraste</a>
  <ul class="collapse">
  <li><a data-scroll-target="#vorbereitung" class="nav-link" id="toc-vorbereitung" href="#vorbereitung">Vorbereitung</a></li>
  <li><a data-scroll-target="#visuelle-analyse" class="nav-link" id="toc-visuelle-analyse" href="#visuelle-analyse">Visuelle Analyse</a></li>
  <li><a data-scroll-target="#bekanntes-modell" class="nav-link" id="toc-bekanntes-modell" href="#bekanntes-modell">Bekanntes Modell</a>
  <ul class="collapse">
  <li><a data-scroll-target="#schritt-1-allgemeines-lineares-modell-anpassen" class="nav-link" id="toc-schritt-1-allgemeines-lineares-modell-anpassen" href="#schritt-1-allgemeines-lineares-modell-anpassen">Schritt 1: Allgemeines lineares Modell anpassen</a></li>
  </ul></li>
  <li><a data-scroll-target="#modell-mit-kontrasten-anstelle-von-dummycodierung" class="nav-link" id="toc-modell-mit-kontrasten-anstelle-von-dummycodierung" href="#modell-mit-kontrasten-anstelle-von-dummycodierung">Modell mit Kontrasten anstelle von Dummycodierung</a>
  <ul class="collapse">
  <li><a data-scroll-target="#prüfung-der-hypothesen" class="nav-link" id="toc-prüfung-der-hypothesen" href="#prüfung-der-hypothesen">Prüfung der Hypothesen</a></li>
  <li><a data-scroll-target="#check-2-analyse-der-residuen" class="nav-link" id="toc-check-2-analyse-der-residuen" href="#check-2-analyse-der-residuen">Check 2: Analyse der Residuen</a></li>
  <li><a data-scroll-target="#check-4-einflussreiche-ausreißer" class="nav-link" id="toc-check-4-einflussreiche-ausreißer" href="#check-4-einflussreiche-ausreißer">Check 4: Einflussreiche Ausreißer</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main id="quarto-document-content" class="content">

<header class="quarto-title-block default" id="title-block-header">
<div class="quarto-title">
<h1 class="title">Datenanalyse ALM - Kontraste</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>YH </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 16, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section class="level1" id="allgemeines-lineares-modell-2---kontraste">
<h1>Allgemeines Lineares Modell 2 - Kontraste</h1>
<p>In der letzten Sitzung haben wir den Behandlungsfaktor per Dummykodierung dichotomisiert. Das ist zwar schon gut, hat aber den Nachteil, dass multiples Testen auftritt, für das korrigiert werden muss.</p>
<p>Um das zu umgehen, lernen wir heute ein noch besseres Verfahren, die Kontraste, (wieder) kennen.</p>
<section class="level2" id="vorbereitung">
<h2 data-anchor-id="vorbereitung" class="anchored">Vorbereitung</h2>
<div class="cell">
<div id="cb1" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a tabindex="-1" aria-hidden="true" href="#cb1-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a tabindex="-1" aria-hidden="true" href="#cb1-2"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-3"><a tabindex="-1" aria-hidden="true" href="#cb1-3"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-4"><a tabindex="-1" aria-hidden="true" href="#cb1-4"></a><span class="fu">library</span>(car)</span>
<span id="cb1-5"><a tabindex="-1" aria-hidden="true" href="#cb1-5"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-6"><a tabindex="-1" aria-hidden="true" href="#cb1-6"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb1-7"><a tabindex="-1" aria-hidden="true" href="#cb1-7"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb1-8"><a tabindex="-1" aria-hidden="true" href="#cb1-8"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-9"><a tabindex="-1" aria-hidden="true" href="#cb1-9"></a><span class="fu">library</span>(predictmeans)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
<p>Auch hier wieder darauf achten, dass das Verzeichnis passt.</p>
<div class="cell">
<div id="cb2" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a tabindex="-1" aria-hidden="true" href="#cb2-1"></a><span class="co">#setwd("Sitzungen")</span></span>
<span id="cb2-2"><a tabindex="-1" aria-hidden="true" href="#cb2-2"></a></span>
<span id="cb2-3"><a tabindex="-1" aria-hidden="true" href="#cb2-3"></a>dat_1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"Dat_VR_Anxiety_lm4.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">dec =</span> <span class="st">"."</span>, <span class="at">na.strings =</span> <span class="st">"NA"</span>)</span>
<span id="cb2-4"><a tabindex="-1" aria-hidden="true" href="#cb2-4"></a></span>
<span id="cb2-5"><a tabindex="-1" aria-hidden="true" href="#cb2-5"></a><span class="co"># Characterstrings als Faktoren definieren</span></span>
<span id="cb2-6"><a tabindex="-1" aria-hidden="true" href="#cb2-6"></a>dat_1<span class="sc">$</span>Gruppe <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat_1<span class="sc">$</span>Gruppe) </span>
<span id="cb2-7"><a tabindex="-1" aria-hidden="true" href="#cb2-7"></a>dat_1<span class="sc">$</span>Gruppe <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_1<span class="sc">$</span>Gruppe, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Warteliste"</span>, <span class="st">"in_sensu"</span>, <span class="st">"in_virtuo"</span>)) </span>
<span id="cb2-8"><a tabindex="-1" aria-hidden="true" href="#cb2-8"></a></span>
<span id="cb2-9"><a tabindex="-1" aria-hidden="true" href="#cb2-9"></a><span class="co"># Change berechnen</span></span>
<span id="cb2-10"><a tabindex="-1" aria-hidden="true" href="#cb2-10"></a></span>
<span id="cb2-11"><a tabindex="-1" aria-hidden="true" href="#cb2-11"></a>dat_1<span class="sc">$</span>Change <span class="ot">&lt;-</span> dat_1<span class="sc">$</span>Post <span class="sc">-</span> dat_1<span class="sc">$</span>Pre</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="level2" id="visuelle-analyse">
<h2 data-anchor-id="visuelle-analyse" class="anchored">Visuelle Analyse</h2>
<div class="cell">
<div id="cb3" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a tabindex="-1" aria-hidden="true" href="#cb3-1"></a><span class="co"># Post als Kriterium/outcome</span></span>
<span id="cb3-2"><a tabindex="-1" aria-hidden="true" href="#cb3-2"></a></span>
<span id="cb3-3"><a tabindex="-1" aria-hidden="true" href="#cb3-3"></a><span class="do">## Prä-Messung</span></span>
<span id="cb3-4"><a tabindex="-1" aria-hidden="true" href="#cb3-4"></a><span class="fu">ggplot</span>(dat_1, <span class="fu">aes</span>(Gruppe, Pre)) <span class="sc">+</span> </span>
<span id="cb3-5"><a tabindex="-1" aria-hidden="true" href="#cb3-5"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb3-6"><a tabindex="-1" aria-hidden="true" href="#cb3-6"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a tabindex="-1" aria-hidden="true" href="#cb3-7"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)  <span class="sc">+</span></span>
<span id="cb3-8"><a tabindex="-1" aria-hidden="true" href="#cb3-8"></a>  <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">"errorbar"</span>, <span class="at">fun.data=</span>mean_cl_normal, <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">col =</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb3-9"><a tabindex="-1" aria-hidden="true" href="#cb3-9"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a tabindex="-1" aria-hidden="true" href="#cb3-10"></a>  <span class="fu">ylab</span>(<span class="st">"Score Anxiety"</span>) <span class="sc">+</span> </span>
<span id="cb3-11"><a tabindex="-1" aria-hidden="true" href="#cb3-11"></a>  <span class="fu">xlab</span>(<span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb3-12"><a tabindex="-1" aria-hidden="true" href="#cb3-12"></a>  <span class="fu">ggtitle</span>(<span class="st">"Belastung vor Behandlung"</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-6-1.png"></p>
</div>
<div id="cb4" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a tabindex="-1" aria-hidden="true" href="#cb4-1"></a><span class="do">## Post-Messung</span></span>
<span id="cb4-2"><a tabindex="-1" aria-hidden="true" href="#cb4-2"></a><span class="fu">ggplot</span>(dat_1, <span class="fu">aes</span>(Gruppe, Post)) <span class="sc">+</span> </span>
<span id="cb4-3"><a tabindex="-1" aria-hidden="true" href="#cb4-3"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb4-4"><a tabindex="-1" aria-hidden="true" href="#cb4-4"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a tabindex="-1" aria-hidden="true" href="#cb4-5"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)  <span class="sc">+</span></span>
<span id="cb4-6"><a tabindex="-1" aria-hidden="true" href="#cb4-6"></a>  <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">"errorbar"</span>, <span class="at">fun.data=</span>mean_cl_normal, <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">col =</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb4-7"><a tabindex="-1" aria-hidden="true" href="#cb4-7"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a tabindex="-1" aria-hidden="true" href="#cb4-8"></a>  <span class="fu">ylab</span>(<span class="st">"Score Anxiety"</span>) <span class="sc">+</span> </span>
<span id="cb4-9"><a tabindex="-1" aria-hidden="true" href="#cb4-9"></a>  <span class="fu">xlab</span>(<span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a tabindex="-1" aria-hidden="true" href="#cb4-10"></a>  <span class="fu">ggtitle</span>(<span class="st">"Belastung nach Behandlung"</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-6-2.png"></p>
</div>
<div id="cb5" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a tabindex="-1" aria-hidden="true" href="#cb5-1"></a><span class="do">## Zusammenhang Pre-Werte und Post-Werte</span></span>
<span id="cb5-2"><a tabindex="-1" aria-hidden="true" href="#cb5-2"></a><span class="fu">ggplot</span>(dat_1, <span class="fu">aes</span>(Pre, Post)) <span class="sc">+</span> </span>
<span id="cb5-3"><a tabindex="-1" aria-hidden="true" href="#cb5-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-4"><a tabindex="-1" aria-hidden="true" href="#cb5-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a tabindex="-1" aria-hidden="true" href="#cb5-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Gruppe)<span class="sc">+</span></span>
<span id="cb5-6"><a tabindex="-1" aria-hidden="true" href="#cb5-6"></a>  <span class="fu">ylab</span>(<span class="st">"Post-Werte"</span>) <span class="sc">+</span> </span>
<span id="cb5-7"><a tabindex="-1" aria-hidden="true" href="#cb5-7"></a>  <span class="fu">xlab</span>(<span class="st">"Prä-Werte"</span>)<span class="sc">+</span></span>
<span id="cb5-8"><a tabindex="-1" aria-hidden="true" href="#cb5-8"></a>  <span class="fu">ggtitle</span>(<span class="st">"Zusammenhang Prä und Post pro Gruppe"</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-6-3.png"></p>
</div>
<div id="cb7" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a tabindex="-1" aria-hidden="true" href="#cb7-1"></a><span class="co"># Veränderung prä zu post als Kriterium</span></span>
<span id="cb7-2"><a tabindex="-1" aria-hidden="true" href="#cb7-2"></a></span>
<span id="cb7-3"><a tabindex="-1" aria-hidden="true" href="#cb7-3"></a><span class="do">## Veraenderung</span></span>
<span id="cb7-4"><a tabindex="-1" aria-hidden="true" href="#cb7-4"></a><span class="fu">ggplot</span>(dat_1, <span class="fu">aes</span>(Gruppe, Change)) <span class="sc">+</span> </span>
<span id="cb7-5"><a tabindex="-1" aria-hidden="true" href="#cb7-5"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb7-6"><a tabindex="-1" aria-hidden="true" href="#cb7-6"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a tabindex="-1" aria-hidden="true" href="#cb7-7"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)  <span class="sc">+</span></span>
<span id="cb7-8"><a tabindex="-1" aria-hidden="true" href="#cb7-8"></a>  <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">"errorbar"</span>, <span class="at">fun.data=</span>mean_cl_normal, <span class="at">width=</span>.<span class="dv">1</span>, <span class="at">col =</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb7-9"><a tabindex="-1" aria-hidden="true" href="#cb7-9"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="sc">+</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a tabindex="-1" aria-hidden="true" href="#cb7-10"></a>  <span class="fu">ylab</span>(<span class="st">"Absolute Change Score Anxiety"</span>) <span class="sc">+</span> </span>
<span id="cb7-11"><a tabindex="-1" aria-hidden="true" href="#cb7-11"></a>  <span class="fu">xlab</span>(<span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb7-12"><a tabindex="-1" aria-hidden="true" href="#cb7-12"></a>  <span class="fu">ggtitle</span>(<span class="st">"Veränderung Belastung Prä zu Post"</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-6-4.png"></p>
</div>
<div id="cb8" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a tabindex="-1" aria-hidden="true" href="#cb8-1"></a><span class="do">## Zusammenhang Pre-Werte und Veränderung</span></span>
<span id="cb8-2"><a tabindex="-1" aria-hidden="true" href="#cb8-2"></a><span class="fu">ggplot</span>(dat_1, <span class="fu">aes</span>(Pre, Change)) <span class="sc">+</span> </span>
<span id="cb8-3"><a tabindex="-1" aria-hidden="true" href="#cb8-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb8-4"><a tabindex="-1" aria-hidden="true" href="#cb8-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a tabindex="-1" aria-hidden="true" href="#cb8-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Gruppe)<span class="sc">+</span></span>
<span id="cb8-6"><a tabindex="-1" aria-hidden="true" href="#cb8-6"></a>  <span class="fu">ylab</span>(<span class="st">"Post-Werte"</span>) <span class="sc">+</span> </span>
<span id="cb8-7"><a tabindex="-1" aria-hidden="true" href="#cb8-7"></a>  <span class="fu">xlab</span>(<span class="st">"Prä-Werte"</span>)<span class="sc">+</span></span>
<span id="cb8-8"><a tabindex="-1" aria-hidden="true" href="#cb8-8"></a>  <span class="fu">ggtitle</span>(<span class="st">"Zusammenhang Prä und Change pro Gruppe"</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-6-5.png"></p>
</div>
</div>
</section>
<section class="level2" id="bekanntes-modell">
<h2 data-anchor-id="bekanntes-modell" class="anchored">Bekanntes Modell</h2>
<p>Score Pre-Treatment und Behandlung sagen Change im Score vorher.</p>
<section class="level3" id="schritt-1-allgemeines-lineares-modell-anpassen">
<h3 data-anchor-id="schritt-1-allgemeines-lineares-modell-anpassen" class="anchored">Schritt 1: Allgemeines lineares Modell anpassen</h3>
<div class="cell">
<div id="cb10" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a tabindex="-1" aria-hidden="true" href="#cb10-1"></a><span class="co"># Zentrierung des kontinuierlichen Praediktors Pre-Wert</span></span>
<span id="cb10-2"><a tabindex="-1" aria-hidden="true" href="#cb10-2"></a>dat_1<span class="sc">$</span>Pre_c <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">scale</span>(dat_1<span class="sc">$</span>Pre, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)) <span class="co"># dient der besseren Interpretierbarkeit</span></span>
<span id="cb10-3"><a tabindex="-1" aria-hidden="true" href="#cb10-3"></a></span>
<span id="cb10-4"><a tabindex="-1" aria-hidden="true" href="#cb10-4"></a><span class="co"># Modelldefinition</span></span>
<span id="cb10-5"><a tabindex="-1" aria-hidden="true" href="#cb10-5"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Change <span class="sc">~</span> Pre_c <span class="sc">+</span> Gruppe, <span class="at">data =</span> dat_1)</span>
<span id="cb10-6"><a tabindex="-1" aria-hidden="true" href="#cb10-6"></a></span>
<span id="cb10-7"><a tabindex="-1" aria-hidden="true" href="#cb10-7"></a><span class="co"># Schaetzung der Parameter</span></span>
<span id="cb10-8"><a tabindex="-1" aria-hidden="true" href="#cb10-8"></a><span class="fu">summary</span>(M1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Change ~ Pre_c + Gruppe, data = dat_1)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.3068 -1.4209  0.0787  1.3778  6.0510 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -0.18728    0.20858  -0.898     0.37    
Pre_c            -0.47281    0.03741 -12.638   &lt;2e-16 ***
Gruppein_sensu   -2.93941    0.29559  -9.944   &lt;2e-16 ***
Gruppein_virtuo -12.35875    0.29505 -41.887   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.085 on 296 degrees of freedom
Multiple R-squared:  0.872, Adjusted R-squared:  0.8707 
F-statistic: 672.3 on 3 and 296 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="cb12" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a tabindex="-1" aria-hidden="true" href="#cb12-1"></a><span class="co"># Deskriptive Mittelwerte</span></span>
<span id="cb12-2"><a tabindex="-1" aria-hidden="true" href="#cb12-2"></a><span class="fu">describeBy</span>(dat_1<span class="sc">$</span>Change, <span class="at">group =</span> dat_1<span class="sc">$</span>Gruppe, <span class="at">data =</span> dat_1, <span class="at">mat =</span> <span class="cn">TRUE</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    item     group1 vars   n   mean       sd median  trimmed    mad min max
X11    1 Warteliste    1 100  -0.14 2.391145      0  -0.1625 1.4826  -6   6
X12    2   in_sensu    1 100  -3.33 2.089198     -3  -3.3125 1.4826 -11   2
X13    3  in_virtuo    1 100 -12.39 3.152344    -12 -12.3500 2.9652 -20  -5
    range        skew     kurtosis        se
X11    12  0.11118794  0.005909878 0.2391145
X12    13 -0.29347808  0.910666324 0.2089198
X13    15 -0.07598674 -0.135420554 0.3152344</code></pre>
</div>
<div id="cb14" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a tabindex="-1" aria-hidden="true" href="#cb14-1"></a><span class="co"># Geschätzte Mittelwerte</span></span>
<span id="cb14-2"><a tabindex="-1" aria-hidden="true" href="#cb14-2"></a>predmeans <span class="ot">&lt;-</span> <span class="fu">predictmeans</span>(M1, <span class="st">"Gruppe"</span>, <span class="at">adj =</span><span class="st">"BH"</span>, <span class="at">barplot =</span> <span class="cn">TRUE</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 The predicted means are estimated at 

Pre_c 
    0 </code></pre>
</div>
<div id="cb16" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a tabindex="-1" aria-hidden="true" href="#cb16-1"></a>predmeans</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Predicted Means`
Gruppe
Warteliste   in_sensu  in_virtuo 
   -0.1873    -3.1267   -12.5460 

$`Standard Error of Means`
Gruppe
Warteliste   in_sensu  in_virtuo 
   0.20858    0.20916    0.20891 

$`Standard Error of Differences`
  Max.SED   Min.SED  Aveg.SED 
0.2962943 0.2950523 0.2956464 

$LSD
 Max.LSD  Min.LSD Aveg.LSD 
 0.58311  0.58067  0.58184 
attr(,"Significant level")
[1] 0.05
attr(,"Degree of freedom")
[1] 296

$`Pairwise p-value`
           Warteliste in_sensu in_virtuo
Warteliste          0   9.9441   41.8866
in_sensu            0   0.0000   31.7905
in_virtuo           0   0.0000    0.0000
attr(,"Degree of freedom")
[1] 296
attr(,"Note")
[1] "The matrix has t-value above the diagonal, p-value (adjusted by 'BH' method) below the diagonal"
attr(,"Letter-based representation of pairwise comparisons at significant level '0.05'")
   Treatment        Mean Group
1 Warteliste  -0.1872813   A  
2   in_sensu  -3.1266905    B 
3  in_virtuo -12.5460282     C

$mean_table
      Gruppe Predicted means Standard error  Df LL of 95% CI UL of 95% CI
1 Warteliste      -0.1872813      0.2085783 296   -0.5977656     0.223203
2   in_sensu      -3.1266905      0.2091643 296   -3.5383282    -2.715053
3  in_virtuo     -12.5460282      0.2089099 296  -12.9571651   -12.134891
  LetterGrp
1       A  
2        B 
3         C</code></pre>
</div>
</div>
<div class="cell">
<div id="cb18" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a tabindex="-1" aria-hidden="true" href="#cb18-1"></a>predmeans<span class="sc">$</span>predictmeansBarPlot</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-10-1.png"></p>
</div>
</div>
<div class="cell">
<div id="cb19" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a tabindex="-1" aria-hidden="true" href="#cb19-1"></a><span class="co"># Geschätzte Mittelwerte</span></span>
<span id="cb19-2"><a tabindex="-1" aria-hidden="true" href="#cb19-2"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Pre_c =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>),<span class="dv">3</span>), <span class="at">Gruppe =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Warteliste"</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">"in_sensu"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"in_virtuo"</span>,<span class="dv">3</span>)))</span>
<span id="cb19-3"><a tabindex="-1" aria-hidden="true" href="#cb19-3"></a>new<span class="sc">$</span>Gruppe <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(new<span class="sc">$</span>Gruppe)</span>
<span id="cb19-4"><a tabindex="-1" aria-hidden="true" href="#cb19-4"></a>                  </span>
<span id="cb19-5"><a tabindex="-1" aria-hidden="true" href="#cb19-5"></a>predmeans1b <span class="ot">&lt;-</span> <span class="fu">predict</span>(M1, <span class="at">newdata =</span> new, <span class="at">interval =</span> <span class="st">"confidence"</span>)</span>
<span id="cb19-6"><a tabindex="-1" aria-hidden="true" href="#cb19-6"></a>predmeans1b.matrix <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(new, predmeans1b))</span>
<span id="cb19-7"><a tabindex="-1" aria-hidden="true" href="#cb19-7"></a>predmeans1b.matrix</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pre_c     Gruppe         fit         lwr        upr
1   -10 Warteliste   4.5408458   3.7043234   5.377368
2     0 Warteliste  -0.1872813  -0.5977656   0.223203
3    10 Warteliste  -4.9154083  -5.7647930  -4.066024
4   -10   in_sensu   1.6014365   0.7307000   2.472173
5     0   in_sensu  -3.1266905  -3.5383282  -2.715053
6    10   in_sensu  -7.8548176  -8.6702551  -7.039380
7   -10  in_virtuo  -7.8179011  -8.6397093  -6.996093
8     0  in_virtuo -12.5460282 -12.9571651 -12.134891
9    10  in_virtuo -17.2741553 -18.1384051 -16.409905</code></pre>
</div>
<div id="cb21" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a tabindex="-1" aria-hidden="true" href="#cb21-1"></a><span class="co"># ANOVA zur Bestimmung der Quadratsummen für die beiden Prädiktoren</span></span>
<span id="cb21-2"><a tabindex="-1" aria-hidden="true" href="#cb21-2"></a><span class="fu">Anova</span>(M1)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Change
          Sum Sq  Df F value    Pr(&gt;F)    
Pre_c      694.6   1  159.71 &lt; 2.2e-16 ***
Gruppe    8311.5   2  955.55 &lt; 2.2e-16 ***
Residuals 1287.3 296                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Hier haben wir neben den aus der letzten Sitzung bekannten Schritten die <code>predict()</code>-Funktion benutzt. Mit dieser können wir das Modell um eine Vorhersage für eine bestimmte Konfiguration der Prädiktoren bitten. Hat eine Person einen <code>Pre_c</code>-Score von -10 (zentriert!) und eine Behandlung in sensu, ließe sich der durch das Modell vorhergsagte Wert also in der <code>predmeans1b.matrix</code>-Tabelle ablesen.</p>
</section>
</section>
<section class="level2" id="modell-mit-kontrasten-anstelle-von-dummycodierung">
<h2 data-anchor-id="modell-mit-kontrasten-anstelle-von-dummycodierung" class="anchored">Modell mit Kontrasten anstelle von Dummycodierung</h2>
<p>Die beiden zu prüfenden Hypothesen waren:</p>
<ol type="1">
<li>CBT ist wirksam.</li>
<li>CBT mit in virtuo Exposition ist wirksamer als CBT mit in sensu Exposition.</li>
</ol>
<p>Diese beiden Kontraste können durch einen Helmert-Kontrast für 3 Ausprägungen eines Faktors erfasst werden. Dazu sortieren wir die Faktorstufen so, dass die Warteliste zuletzt kommt, damit in einem Vergleich <code>in_sensu</code> mit <code>in_virtuo</code> und im zweiten Vergleich diese beiden zusammen mit der Warteliste verglichen werden.</p>
<div class="cell">
<div id="cb23" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a tabindex="-1" aria-hidden="true" href="#cb23-1"></a>dat_1<span class="sc">$</span>Gruppe <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_1<span class="sc">$</span>Gruppe, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"in_virtuo"</span>, <span class="st">"in_sensu"</span>, <span class="st">"Warteliste"</span>))</span>
<span id="cb23-2"><a tabindex="-1" aria-hidden="true" href="#cb23-2"></a></span>
<span id="cb23-3"><a tabindex="-1" aria-hidden="true" href="#cb23-3"></a><span class="fu">contrasts</span>(dat_1<span class="sc">$</span>Gruppe) <span class="ot">&lt;-</span> <span class="fu">contr.helmert</span>(<span class="dv">3</span>)</span>
<span id="cb23-4"><a tabindex="-1" aria-hidden="true" href="#cb23-4"></a><span class="fu">contrasts</span>(dat_1<span class="sc">$</span>Gruppe)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1] [,2]
in_virtuo    -1   -1
in_sensu      1   -1
Warteliste    0    2</code></pre>
</div>
</div>
<p>Zuletzt schauen wir uns noch an, ob die Kontraste richtig gesetzt sind (nützlich zur Selbstüberprüfung).</p>
<section class="level3" id="prüfung-der-hypothesen">
<h3 data-anchor-id="prüfung-der-hypothesen" class="anchored">Prüfung der Hypothesen</h3>
<div class="cell">
<div id="cb25" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a tabindex="-1" aria-hidden="true" href="#cb25-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Change <span class="sc">~</span> Pre_c <span class="sc">+</span> Gruppe, <span class="at">data =</span> dat_1)</span>
<span id="cb25-2"><a tabindex="-1" aria-hidden="true" href="#cb25-2"></a><span class="fu">summary</span>(M2)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Change ~ Pre_c + Gruppe, data = dat_1)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.3068 -1.4209  0.0787  1.3778  6.0510 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -5.28667    0.12040  -43.91   &lt;2e-16 ***
Pre_c       -0.47281    0.03741  -12.64   &lt;2e-16 ***
Gruppe1      4.70967    0.14815   31.79   &lt;2e-16 ***
Gruppe2      2.54969    0.08516   29.94   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.085 on 296 degrees of freedom
Multiple R-squared:  0.872, Adjusted R-squared:  0.8707 
F-statistic: 672.3 on 3 and 296 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="cb27" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a tabindex="-1" aria-hidden="true" href="#cb27-1"></a><span class="co"># Mittelwert Change overall</span></span>
<span id="cb27-2"><a tabindex="-1" aria-hidden="true" href="#cb27-2"></a><span class="fu">mean</span>(dat_1<span class="sc">$</span>Change)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -5.286667</code></pre>
</div>
<div id="cb29" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a tabindex="-1" aria-hidden="true" href="#cb29-1"></a><span class="co"># Vorhergesagte Mittelwerte</span></span>
<span id="cb29-2"><a tabindex="-1" aria-hidden="true" href="#cb29-2"></a>pred.means2 <span class="ot">&lt;-</span> <span class="fu">predictmeans</span>(M2, <span class="st">"Gruppe"</span>, <span class="at">adj =</span><span class="st">"BH"</span>, <span class="at">barplot =</span> <span class="cn">TRUE</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 The predicted means are estimated at 

Pre_c 
    0 </code></pre>
</div>
<div id="cb31" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a tabindex="-1" aria-hidden="true" href="#cb31-1"></a>pred.means2</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Predicted Means`
Gruppe
 in_virtuo   in_sensu Warteliste 
  -12.5460    -3.1267    -0.1873 

$`Standard Error of Means`
Gruppe
 in_virtuo   in_sensu Warteliste 
   0.20891    0.20916    0.20858 

$`Standard Error of Differences`
  Max.SED   Min.SED  Aveg.SED 
0.2962943 0.2950523 0.2956464 

$LSD
 Max.LSD  Min.LSD Aveg.LSD 
 0.58311  0.58067  0.58184 
attr(,"Significant level")
[1] 0.05
attr(,"Degree of freedom")
[1] 296

$`Pairwise p-value`
           in_virtuo in_sensu Warteliste
in_virtuo          0 -31.7905   -41.8866
in_sensu           0   0.0000    -9.9441
Warteliste         0   0.0000     0.0000
attr(,"Degree of freedom")
[1] 296
attr(,"Note")
[1] "The matrix has t-value above the diagonal, p-value (adjusted by 'BH' method) below the diagonal"
attr(,"Letter-based representation of pairwise comparisons at significant level '0.05'")
   Treatment        Mean Group
1 Warteliste  -0.1872813   A  
2   in_sensu  -3.1266905    B 
3  in_virtuo -12.5460282     C

$mean_table
      Gruppe Predicted means Standard error  Df LL of 95% CI UL of 95% CI
1  in_virtuo     -12.5460282      0.2089099 296  -12.9571651   -12.134891
2   in_sensu      -3.1266905      0.2091643 296   -3.5383282    -2.715053
3 Warteliste      -0.1872813      0.2085783 296   -0.5977656     0.223203
  LetterGrp
1       A  
2        B 
3         C</code></pre>
</div>
</div>
<div class="cell">
<div id="cb33" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a tabindex="-1" aria-hidden="true" href="#cb33-1"></a>pred.means2<span class="sc">$</span>predictmeansBarPlot</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-18-1.png"></p>
</div>
</div>
<div class="cell">
<div id="cb34" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a tabindex="-1" aria-hidden="true" href="#cb34-1"></a><span class="fu">Anova</span>(M2)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Change
          Sum Sq  Df F value    Pr(&gt;F)    
Pre_c      694.6   1  159.71 &lt; 2.2e-16 ***
Gruppe    8311.5   2  955.55 &lt; 2.2e-16 ***
Residuals 1287.3 296                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Die Koeffizienten von Kontrastprädiktoren ließen sich zwar mathematisch genau interpretieren, aber uns interessiert nur die Richtung (und natürlich die Signifikanz). Um der Frage vorzubeugen, wie sich das denn genau machen ließe, wird das im nächsten Absatz beschrieben. Zunächst aber zu der einfachen Variante:</p>
<ol type="1">
<li>Der Regressionsparameter ist positiv, was bedeutet, dass die Stufen mit positiven Kontrastkoeffizienten einen höheren Change-Wert haben. Je niedriger der Change-Wert ist, desto höher ist die Verbesserung. Zusammen bedeutet das, dass Menschen mit Exposition in sensu eine geringere Verbesserung aufweisen (positiver Regressionsparameter + positiver Kontrastkoeffizient =&gt; höherer Change-Wert =&gt; geringere Verbesserung).</li>
<li>Mit der gleichen Logik haben Menschen in der Warteliste eine noch geringere Verbesserung (positiver Regressionsparameter + positiver Kontrastkoeffizient =&gt; höherer Change-Wert =&gt; geringere Verbesserung).</li>
</ol>
<p>Und nun für alle besonders Interessierten: Das Modell gibt uns zusammen mit den Kontrastkoeffizienten schon vor, wie wir die genauen Unterschiede zwischen den Mittelwerten der verschiedenen Gruppen ausrechnen müssen. So gilt:</p>
<ol type="1">
<li>delta_in_virtuo = (-1) * beta_Gruppe1 + (-1) * beta_Gruppe2 ~= -4.71 - 2.55 = -7.26</li>
<li>delta_in_sensu = 1 * beta_Gruppe1 + (-1) * beta_Gruppe2 ~= 4.71 - 2.55 = 2.16</li>
<li>delta_Warteliste = 0 * beta_Gruppe1 + 2 * beta_Gruppe2 ~= 2 * 2.55 = 5.10</li>
</ol>
<p>Ich habe dabei ein “delta” vor die Ausprägung geschrieben, weil das Ergebnis noch mit den anderen Prädiktoren verrechnet werden müsste, um den wirklichen Mittelwert in der Gruppe zu erhalten (vor allem mit dem Intercept).</p>
</section>
<section class="level3" id="check-2-analyse-der-residuen">
<h3 data-anchor-id="check-2-analyse-der-residuen" class="anchored">Check 2: Analyse der Residuen</h3>
<div class="cell">
<div id="cb36" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a tabindex="-1" aria-hidden="true" href="#cb36-1"></a><span class="do">## Verteilung der Residuen</span></span>
<span id="cb36-2"><a tabindex="-1" aria-hidden="true" href="#cb36-2"></a><span class="fu">plotNormalDensity</span>(M2<span class="sc">$</span>residuals)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-22-1.png"></p>
</div>
<div id="cb37" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a tabindex="-1" aria-hidden="true" href="#cb37-1"></a><span class="do">## Verteilung der Residuen in Abhängigkeit von vorhergesagten Werten</span></span>
<span id="cb37-2"><a tabindex="-1" aria-hidden="true" href="#cb37-2"></a><span class="fu">scatterplot</span>(<span class="fu">rstandard</span>(M2)<span class="sc">~</span><span class="fu">fitted</span>(M2))</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-22-2.png"></p>
</div>
<div id="cb38" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a tabindex="-1" aria-hidden="true" href="#cb38-1"></a><span class="fu">scatterplot</span>(<span class="fu">rstandard</span>(M2)<span class="sc">~</span>dat_1<span class="sc">$</span>ID)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-22-3.png"></p>
</div>
<div id="cb39" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a tabindex="-1" aria-hidden="true" href="#cb39-1"></a><span class="do">## Statistischer Test auf Homoskedastizität: Breusch-Pagan Test</span></span>
<span id="cb39-2"><a tabindex="-1" aria-hidden="true" href="#cb39-2"></a><span class="fu">bptest</span>(M2)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  M2
BP = 2.5162, df = 3, p-value = 0.4724</code></pre>
</div>
</div>
</section>
<section class="level3" id="check-4-einflussreiche-ausreißer">
<h3 data-anchor-id="check-4-einflussreiche-ausreißer" class="anchored">Check 4: Einflussreiche Ausreißer</h3>
<p>Cook’s distance ist ein gutes Maß zur Ermittlung zu einflussreicher Ausreißer. Die Werte der einzelnen Fälle sollte nicht größer sein als 4/(N-k-1). Die Summe sollte bei 1 liegen.</p>
<div class="cell">
<div id="cb41" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a tabindex="-1" aria-hidden="true" href="#cb41-1"></a>cd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(M2)</span>
<span id="cb41-2"><a tabindex="-1" aria-hidden="true" href="#cb41-2"></a><span class="co">#View(cd)</span></span>
<span id="cb41-3"><a tabindex="-1" aria-hidden="true" href="#cb41-3"></a><span class="fu">plot</span>(M2,<span class="dv">4</span>)</span>
<span id="cb41-4"><a tabindex="-1" aria-hidden="true" href="#cb41-4"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.0273</span>)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-24-1.png"></p>
</div>
<div id="cb42" class="sourceCode cell-code"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a tabindex="-1" aria-hidden="true" href="#cb42-1"></a><span class="fu">hist</span>(cd)</span></code><button class="code-copy-button" title="Copy to Clipboard"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img width="672" class="img-fluid" src="1_ALM_2_files/figure-html/unnamed-chunk-24-2.png"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script type="application/javascript" id="quarto-html-after-body">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="1_ALM_2_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>